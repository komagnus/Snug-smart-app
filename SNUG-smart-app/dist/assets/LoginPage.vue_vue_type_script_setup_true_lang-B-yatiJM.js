import{p as q,I as ae,a as Se,m as te,b as Ie,e as we,g as J,u as O,f as ne,h as p,i as xe,j as Ue,k as Be,t as B,l as Q,n as V,R as De,s as se,r,q as fe,v as H,w as Fe,x as Pe,F as ye,V as Ae,y as Le,z as Te,A as _e,B as ee,C as Ne,D as We,E as Ee,G as Re,H as Ve,J as $e,K as Ge,L as re,M as je,N as qe,O as Me,d as ze,P as Ke,Q as Oe,S as He,o as g,T as z,U as $,W as ie,X as Je,Y as Qe,c as w,Z as D,_ as x,$ as K,a0 as le,a1 as j,a2 as Xe,a3 as ce,a4 as de,a5 as Ye,a6 as Ze,a7 as el,a8 as ll,a9 as al,aa as tl,ab as nl,ac as ol,ad as ul,ae as sl}from"./index-c_BNGV0K.js";const be=Symbol.for("vuetify:selection-control-group"),ke=q({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:ae,trueIcon:ae,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:Se},...te(),...Ie(),...we()},"SelectionControlGroup"),rl=q({...ke({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");J()({name:"VSelectionControlGroup",props:rl(),emits:{"update:modelValue":e=>!0},setup(e,b){let{slots:k}=b;const n=O(e,"modelValue"),a=ne(),m=p(()=>e.id||`v-selection-control-group-${a}`),i=p(()=>e.name||m.value),u=new Set;return xe(be,{modelValue:n,forceUpdate:()=>{u.forEach(o=>o())},onForceUpdate:o=>{u.add(o),Ue(()=>{u.delete(o)})}}),Be({[e.defaultsTarget]:{color:B(e,"color"),disabled:B(e,"disabled"),density:B(e,"density"),error:B(e,"error"),inline:B(e,"inline"),modelValue:n,multiple:p(()=>!!e.multiple||e.multiple==null&&Array.isArray(n.value)),name:i,falseIcon:B(e,"falseIcon"),trueIcon:B(e,"trueIcon"),readonly:B(e,"readonly"),ripple:B(e,"ripple"),type:B(e,"type"),valueComparator:B(e,"valueComparator")}}),Q(()=>{var o;return V("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class],style:e.style,role:e.type==="radio"?"radiogroup":void 0},[(o=k.default)==null?void 0:o.call(k)])}),{}}});const ge=q({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...te(),...ke()},"VSelectionControl");function il(e){const b=Te(be,void 0),{densityClasses:k}=_e(e),n=O(e,"modelValue"),a=p(()=>e.trueValue!==void 0?e.trueValue:e.value!==void 0?e.value:!0),m=p(()=>e.falseValue!==void 0?e.falseValue:!1),i=p(()=>!!e.multiple||e.multiple==null&&Array.isArray(n.value)),u=p({get(){const C=b?b.modelValue.value:n.value;return i.value?ee(C).some(y=>e.valueComparator(y,a.value)):e.valueComparator(C,a.value)},set(C){if(e.readonly)return;const y=C?a.value:m.value;let h=y;i.value&&(h=C?[...ee(n.value),y]:ee(n.value).filter(S=>!e.valueComparator(S,a.value))),b?b.modelValue.value=h:n.value=h}}),{textColorClasses:o,textColorStyles:d}=Ne(p(()=>{if(!(e.error||e.disabled))return u.value?e.color:e.baseColor})),{backgroundColorClasses:f,backgroundColorStyles:c}=We(p(()=>u.value&&!e.error&&!e.disabled?e.color:void 0)),v=p(()=>u.value?e.trueIcon:e.falseIcon);return{group:b,densityClasses:k,trueValue:a,falseValue:m,model:u,textColorClasses:o,textColorStyles:d,backgroundColorClasses:f,backgroundColorStyles:c,icon:v}}const ve=J()({name:"VSelectionControl",directives:{Ripple:De},inheritAttrs:!1,props:ge(),emits:{"update:modelValue":e=>!0},setup(e,b){let{attrs:k,slots:n}=b;const{group:a,densityClasses:m,icon:i,model:u,textColorClasses:o,textColorStyles:d,backgroundColorClasses:f,backgroundColorStyles:c,trueValue:v}=il(e),C=ne(),y=se(!1),h=se(!1),S=r(),U=p(()=>e.id||`input-${C}`),A=p(()=>!e.disabled&&!e.readonly);a==null||a.onForceUpdate(()=>{S.value&&(S.value.checked=u.value)});function F(I){A.value&&(y.value=!0,Ee(I.target,":focus-visible")!==!1&&(h.value=!0))}function s(){y.value=!1,h.value=!1}function X(I){A.value&&(e.readonly&&a&&Re(()=>a.forceUpdate()),u.value=I.target.checked)}return Q(()=>{var N,P;const I=n.label?n.label({label:e.label,props:{for:U.value}}):e.label,[G,L]=fe(k),_=V("input",H({ref:S,checked:u.value,disabled:!!e.disabled,id:U.value,onBlur:s,onFocus:F,onInput:X,"aria-disabled":!!e.disabled,type:e.type,value:v.value,name:e.name,"aria-checked":e.type==="checkbox"?u.value:void 0},L),null);return V("div",H({class:["v-selection-control",{"v-selection-control--dirty":u.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":y.value,"v-selection-control--focus-visible":h.value,"v-selection-control--inline":e.inline},m.value,e.class]},G,{style:e.style}),[V("div",{class:["v-selection-control__wrapper",o.value],style:d.value},[(N=n.default)==null?void 0:N.call(n,{backgroundColorClasses:f,backgroundColorStyles:c}),Fe(V("div",{class:["v-selection-control__input"]},[((P=n.input)==null?void 0:P.call(n,{model:u,textColorClasses:o,textColorStyles:d,backgroundColorClasses:f,backgroundColorStyles:c,inputNode:_,icon:i.value,props:{onFocus:F,onBlur:s,id:U.value}}))??V(ye,null,[i.value&&V(Ae,{key:"icon",icon:i.value},null),_])]),[[Pe("ripple"),e.ripple&&[!e.disabled&&!e.readonly,null,["center","circle"]]]])]),I&&V(Le,{for:U.value,clickable:!0,onClick:Z=>Z.stopPropagation()},{default:()=>[I]})])}),{isFocused:y,input:S}}}),Ce=q({indeterminate:Boolean,indeterminateIcon:{type:ae,default:"$checkboxIndeterminate"},...ge({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),me=J()({name:"VCheckboxBtn",props:Ce(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,b){let{slots:k}=b;const n=O(e,"indeterminate"),a=O(e,"modelValue");function m(o){n.value&&(n.value=!1)}const i=p(()=>n.value?e.indeterminateIcon:e.falseIcon),u=p(()=>n.value?e.indeterminateIcon:e.trueIcon);return Q(()=>{const o=Ve(ve.filterProps(e),["modelValue"]);return V(ve,H(o,{modelValue:a.value,"onUpdate:modelValue":[d=>a.value=d,m],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:i.value,trueIcon:u.value,"aria-checked":n.value?"mixed":void 0}),k)}),{}}}),cl=q({...$e(),...Ve(Ce(),["inline"])},"VCheckbox"),dl=J()({name:"VCheckbox",inheritAttrs:!1,props:cl(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,b){let{attrs:k,slots:n}=b;const a=O(e,"modelValue"),{isFocused:m,focus:i,blur:u}=Ge(e),o=ne(),d=p(()=>e.id||`checkbox-${o}`);return Q(()=>{const[f,c]=fe(k),v=re.filterProps(e),C=me.filterProps(e);return V(re,H({class:["v-checkbox",e.class]},f,v,{modelValue:a.value,"onUpdate:modelValue":y=>a.value=y,id:d.value,focused:m.value,style:e.style}),{...n,default:y=>{let{id:h,messagesId:S,isDisabled:U,isReadonly:A}=y;return V(me,H(C,{id:h.value,"aria-describedby":S.value,disabled:U.value,readonly:A.value},c,{modelValue:a.value,"onUpdate:modelValue":F=>a.value=F,onFocus:i,onBlur:u}),n)}})}),{}}}),vl=q({...te(),...je()},"VForm"),ml=J()({name:"VForm",props:vl(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,b){let{slots:k,emit:n}=b;const a=qe(e),m=r();function i(o){o.preventDefault(),a.reset()}function u(o){const d=o,f=a.validate();d.then=f.then.bind(f),d.catch=f.catch.bind(f),d.finally=f.finally.bind(f),n("submit",d),d.defaultPrevented||f.then(c=>{var C;let{valid:v}=c;v&&((C=m.value)==null||C.submit())}),d.preventDefault()}return Q(()=>{var o;return V("form",{ref:m,class:["v-form",e.class],style:e.style,novalidate:!0,onReset:i,onSubmit:u},[(o=k.default)==null?void 0:o.call(k,a)])}),Me(a,m)}}),fl=j("img",{src:Xe},null,-1),yl={key:9,style:{color:"red"}},Vl={key:10,style:{color:"red"}},bl={key:11,style:{color:"red"}},kl=j("br",null,null,-1),gl={key:12},Cl=j("br",null,null,-1),pl=ze({__name:"LoginPage",setup(e){const b=Ke(),k=Oe(),n=He(),a=r(""),m=r(""),i=r(""),u=r(""),o=r(""),d=r(""),f=r(!1),c=r(!1),v=r(!1),C=r(!1),y=r(""),h=r(0),S=r(0),U=r(""),A=r(!1),F=r(!1),s=b.User,X=k,I=r(!1),G=r(!1),L=r(""),_=r(""),N=r(""),P=r(0);async function Z(){try{c.value=!0;const l=(await ce()).access_token,t=await de(a.value,l);if(t.document!==null)if(t.document.username===a.value&&t.document.userpw===m.value){const E=await Ye(t.document._id,l);U.value=t._id,d.value=t.name,a.value=t.username,I.value=!0,i.value=E.document.clientid,u.value=E.document.clientsecret,o.value=E.document.serialnumber,h.value=E.document.lat,S.value=E.document.lng;const R=await Ze(U.value,l);R.document!==null&&(s.WeatherStation.Id=R.document.wlstationid,s.WeatherStation.ApiKey=R.document.wlapikey,s.WeatherStation.ApiSecret=R.document.wlapisecret);const Y=await el(U.value,l);Y.document!==null&&(P.value=Y.document.pricelimit),n.push("/mainContent")}else M.value=!0;else M.value=!0}catch(T){console.log(T)}finally{s.Name=d.value,s.UserName=a.value,s.IsLoggedIn=I.value,s.UserId=U.value,s.ClientID=i.value,s.ClientSecret=u.value,s.SerialNumber=o.value,s.ClientLocation.Lat=h.value,s.ClientLocation.Lng=S.value,X.PriceLimit=P.value,I.value&&n.push("/mainContent"),c.value=!1}}async function he(){try{F.value=!1,c.value=!0;const l=(await ce()).access_token,t=await de(a.value,l);if(console.log(t.document),t.document!==null){F.value=!0;return}else{const E=await ll(l,a.value,m.value);if(y.value=E.insertedId,!C.value){const R=await al(i.value,u.value),Y=await tl(o.value,R.access_token),ue=await nl(Y.location.id,R.access_token);h.value=ue.lat,S.value=ue.lng}L.value!==""&&await ol(l,y.value,L.value,N.value,_.value),await ul(l,y.value,P.value),I.value=!0,await sl(l,y.value,i.value,u.value,o.value,h.value,S.value)}}catch(T){console.log(T)}finally{s.Name=d.value,s.UserName=a.value,s.IsLoggedIn=I.value,s.UserId=y.value,s.ClientID=i.value,s.ClientSecret=u.value,s.SerialNumber=o.value,s.ClientLocation.Lat=h.value,s.ClientLocation.Lng=S.value,L.value!==""&&(s.WeatherStation.Id=L.value,s.WeatherStation.ApiKey=_.value,s.WeatherStation.ApiSecret=N.value),X.PriceLimit=P.value,I.value&&n.push("/mainContent"),c.value=!1}}function oe(){v.value===!0?(M.value=!1,A.value=!1,F.value=!1,v.value=!1):(M.value=!1,A.value=!1,v.value=!0)}async function pe(){v.value?await he():await Z()}const M=r(!1);function W(T){return!!T||"Field is required"}return(T,l)=>(g(),z(ye,null,[V(ie,{style:{display:"flex",height:"20%",width:"100%","justify-content":"center","flex-direction":"row","align-items":"center"}},{default:$(()=>[fl]),_:1}),V(ie,{style:{display:"flex",height:"50%",width:"100%","margin-top":"10%","justify-content":"center","flex-direction":"row","align-items":"center"}},{default:$(()=>[V(Je,{class:"mx-auto px-6 py-8",style:{width:"60%","min-width":"300px","max-width":"600px"}},{default:$(()=>[V(ml,{modelValue:f.value,"onUpdate:modelValue":l[12]||(l[12]=t=>f.value=t),onSubmit:Qe(pe,["prevent"])},{default:$(()=>[v.value?(g(),w(D,{key:0,modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=t=>d.value=t),readonly:c.value,rules:[W],class:"mb-2",clearable:"",label:"Name"},null,8,["modelValue","readonly","rules"])):x("",!0),V(D,{modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value=t),readonly:c.value,rules:[W],class:"mb-2",clearable:"",label:"Email"},null,8,["modelValue","readonly","rules"]),V(D,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=t=>m.value=t),readonly:c.value,rules:[W],clearable:"",type:"password",label:"Password",placeholder:"Enter your password"},null,8,["modelValue","readonly","rules"]),v.value?(g(),w(D,{key:1,modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=t=>i.value=t),readonly:c.value,rules:[W],clearable:"",label:"Client ID",placeholder:"Enter your airthings account ClientID"},null,8,["modelValue","readonly","rules"])):x("",!0),v.value?(g(),w(D,{key:2,modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=t=>u.value=t),readonly:c.value,rules:[W],clearable:"",label:"Clientsecret",placeholder:"Enter your airthings account ClientSecret"},null,8,["modelValue","readonly","rules"])):x("",!0),v.value?(g(),w(D,{key:3,modelValue:o.value,"onUpdate:modelValue":l[5]||(l[5]=t=>o.value=t),readonly:c.value,rules:[W],clearable:"",label:"Serialnumber",placeholder:"Enter your airthings device SerialNumber"},null,8,["modelValue","readonly","rules"])):x("",!0),v.value?(g(),w(D,{key:4,type:"number",modelValue:P.value,"onUpdate:modelValue":l[6]||(l[6]=t=>P.value=t),readonly:c.value,rules:[W],clearable:"",label:"Price limit",placeholder:"Enter your desired pricelimit for electricity price"},null,8,["modelValue","readonly","rules"])):x("",!0),v.value?(g(),w(le,{key:5,onClick:l[7]||(l[7]=t=>G.value=!0)},{default:$(()=>[K("Add weatherlink station?")]),_:1})):x("",!0),G.value?(g(),w(D,{key:6,modelValue:L.value,"onUpdate:modelValue":l[8]||(l[8]=t=>L.value=t),placeholder:"Weatherlink station ID"},null,8,["modelValue"])):x("",!0),G.value?(g(),w(D,{key:7,modelValue:_.value,"onUpdate:modelValue":l[9]||(l[9]=t=>_.value=t),placeholder:"Weatherlink api key"},null,8,["modelValue"])):x("",!0),G.value?(g(),w(D,{key:8,modelValue:N.value,"onUpdate:modelValue":l[10]||(l[10]=t=>N.value=t),placeholder:"Weatherlink api secret"},null,8,["modelValue"])):x("",!0),M.value?(g(),z("p",yl,"Incorrect email and/or password")):A.value?(g(),z("p",Vl,"Incorrect email and/or password")):F.value?(g(),z("p",bl,[K("A user with this email is already registered "),j("span",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:oe}," Sign in instead")])):x("",!0),kl,v.value?x("",!0):(g(),z("div",gl,[j("p",null,[K("First time? Sign up and register device "),j("span",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:oe},"here")])])),v.value?(g(),w(dl,{key:13,modelValue:C.value,"onUpdate:modelValue":l[11]||(l[11]=t=>C.value=t),label:"Test User"},null,8,["modelValue"])):x("",!0),Cl,v.value?(g(),w(le,{key:15,disabled:!f.value,loading:c.value,block:"",type:"submit",color:"success",size:"large",variant:"elevated"},{default:$(()=>[K(" Sign Up ")]),_:1},8,["disabled","loading"])):(g(),w(le,{key:14,disabled:!f.value,loading:c.value,block:"",color:"success",size:"large",type:"submit",variant:"elevated"},{default:$(()=>[K(" Sign In ")]),_:1},8,["disabled","loading"]))]),_:1},8,["modelValue"])]),_:1})]),_:1})],64))}});export{pl as _};
